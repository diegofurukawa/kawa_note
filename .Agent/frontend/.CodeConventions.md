# CODE CONVENTIONS — FRONTEND

## Herança Global
Este arquivo **estende** `/.Agent/.CodeConventions.md` com regras específicas para frontend.

**Nenhuma regra aqui afroxa as convenções globais.**

---

## Padrões de Linguagem e Framework
- **Linguagem:** JavaScript (ESNext)
- **Framework:** React 18.2.0
- **Build Tool:** Vite 6.1.0
- **Componentes:** Funcionais com Hooks
- **Estilização:** Tailwind CSS 3.4.17
- **UI Components:** Shadcn UI (Radix UI)

---

## Organização de Arquivos
```
src/
├── components/
│   ├── ui/                    # Shadcn UI (não modificar)
│   ├── notes/                 # Componentes de negócio
│   │   ├── NoteCard.jsx
│   │   ├── NoteEditor.jsx
│   │   ├── QuickEditor.jsx
│   │   ├── RelatedNotes.jsx
│   │   └── SearchBar.jsx
│   ├── layout/                # Layout compartilhado
│   │   ├── Header.jsx
│   │   ├── Sidebar.jsx
│   │   └── Footer.jsx
│   └── UserNotRegisteredError.jsx
├── pages/                     # Páginas (rotas)
│   ├── Home.jsx
│   ├── Notes.jsx
│   ├── Folders.jsx
│   └── NotFound.jsx
├── hooks/                     # Custom hooks
│   ├── useMobile.jsx
│   ├── useAuth.jsx
│   └── useNotes.jsx
├── api/                       # Integração com backend
│   ├── client.js              # Axios/Fetch client
│   ├── index.js               # Exports
│   ├── useAuth.js             # Hook de auth
│   ├── useFolders.js          # Hook de folders
│   ├── useNotes.js            # Hook de notes
│   └── useRelations.js        # Hook de relations
├── lib/                       # Utilitários e contextos
│   ├── utils.js               # Funções auxiliares
│   ├── constants.js           # Constantes
│   └── AuthContext.jsx        # Contexto de autenticação
├── styles/                    # Estilos globais
│   ├── globals.css
│   └── tailwind.css
├── App.jsx                    # Componente raiz
├── main.jsx                   # Entry point
└── index.html                 # HTML template
```

---

## Regras de Código (ESLint)
- **Variáveis não utilizadas:** Devem ser removidas ou prefixadas com `_`.
- **Importações:** Usar plugin `unused-imports` para manter o código limpo.
- **React:** Não é necessário importar `React` em escopo JSX (React 17+ pattern).
- **Hooks:** Seguir rigorosamente `rules-of-hooks`.
- **Props:** Usar destructuring em parâmetros de componentes.

---

## Convenções de Nomenclatura
- **Arquivos de Componente:** PascalCase (ex: `NoteEditor.jsx`)
- **Hooks:** camelCase com prefixo `use` (ex: `useNotes.js`)
- **Arquivos Utilitários:** camelCase ou lowercase (ex: `utils.js`)
- **Constantes:** UPPER_SNAKE_CASE (ex: `MAX_NOTE_LENGTH`)
- **Variáveis:** camelCase (ex: `noteTitle`)

---

## Padrão de Componentes

### Componente Funcional
```javascript
/**
 * NoteCard - Exibe uma nota em formato de card
 * @param {Object} props
 * @param {string} props.id - ID da nota
 * @param {string} props.title - Título da nota
 * @param {string} props.content - Conteúdo da nota
 * @param {Function} props.onEdit - Callback ao editar
 * @returns {JSX.Element}
 */
export function NoteCard({ id, title, content, onEdit }) {
  return (
    <div className="p-4 border rounded-lg">
      <h3 className="font-bold">{title}</h3>
      <p className="text-sm text-gray-600">{content}</p>
      <button onClick={() => onEdit(id)}>Editar</button>
    </div>
  );
}
```

### Custom Hook
```javascript
/**
 * useNotes - Hook para gerenciar notas
 * @returns {Object} { notes, loading, error, createNote, updateNote, deleteNote }
 */
export function useNotes() {
  const [notes, setNotes] = useState([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const createNote = useCallback(async (data) => {
    setLoading(true);
    try {
      const response = await api.post('/notes', data);
      setNotes([...notes, response.data]);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  }, [notes]);

  return { notes, loading, error, createNote };
}
```

---

## Gerenciamento de Estado

### React Query (@tanstack/react-query)
```javascript
import { useQuery, useMutation } from '@tanstack/react-query';

export function useNotes() {
  const { data: notes, isLoading } = useQuery({
    queryKey: ['notes'],
    queryFn: () => api.get('/notes'),
  });

  const { mutate: createNote } = useMutation({
    mutationFn: (data) => api.post('/notes', data),
    onSuccess: () => queryClient.invalidateQueries(['notes']),
  });

  return { notes, isLoading, createNote };
}
```

### Context API (para estado global)
```javascript
export const AuthContext = createContext();

export function AuthProvider({ children }) {
  const [user, setUser] = useState(null);

  return (
    <AuthContext.Provider value={{ user, setUser }}>
      {children}
    </AuthContext.Provider>
  );
}
```

---

## Formulários com React Hook Form + Zod

```javascript
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';

const noteSchema = z.object({
  title: z.string().min(1, 'Título obrigatório'),
  content: z.string().min(1, 'Conteúdo obrigatório'),
});

export function NoteForm() {
  const { register, handleSubmit, formState: { errors } } = useForm({
    resolver: zodResolver(noteSchema),
  });

  const onSubmit = (data) => {
    console.log(data);
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <input {...register('title')} />
      {errors.title && <span>{errors.title.message}</span>}
      <button type="submit">Salvar</button>
    </form>
  );
}
```

---

## Estilização com Tailwind CSS

### Convenções
- Usar classes Tailwind em vez de CSS customizado quando possível.
- Evitar `!important`.
- Usar `clsx` ou `tailwind-merge` para classes condicionais.

### Exemplo
```javascript
import { clsx } from 'clsx';

export function Button({ variant = 'primary', disabled, children }) {
  return (
    <button
      className={clsx(
        'px-4 py-2 rounded-lg font-semibold',
        {
          'bg-blue-500 text-white': variant === 'primary',
          'bg-gray-200 text-gray-800': variant === 'secondary',
          'opacity-50 cursor-not-allowed': disabled,
        }
      )}
      disabled={disabled}
    >
      {children}
    </button>
  );
}
```

---

## Caminhos (Aliases)
- Utilizar `@/*` para referenciar o diretório `./src/`.
- Exemplo: `import { useNotes } from '@/hooks/useNotes'`

---

## Integração com Backend

### API Client
```javascript
// src/api/client.js
import axios from 'axios';

const client = axios.create({
  baseURL: import.meta.env.VITE_API_URL || 'http://localhost:3000/api',
});

client.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

export default client;
```

### Hooks de API
```javascript
// src/api/useNotes.js
import { useQuery, useMutation } from '@tanstack/react-query';
import client from './client';

export function useNotes() {
  return useQuery({
    queryKey: ['notes'],
    queryFn: () => client.get('/notes').then(res => res.data),
  });
}
```

---

## Acessibilidade
- Usar `aria-*` attributes quando necessário.
- Garantir navegação por teclado.
- Usar labels em formulários.
- Testar com screen readers.

---

## Performance
- Usar `React.memo` para componentes que recebem props complexas.
- Usar `useCallback` para funções passadas como props.
- Usar `useMemo` para cálculos custosos.
- Lazy load componentes com `React.lazy` e `Suspense`.

---

## Testes
- **Framework:** Vitest + React Testing Library
- **Padrão:** `<component>.test.jsx` no mesmo diretório.
- **Cobertura:** Mínimo 80% para componentes críticos.

---

## Documentação
- **Storybook:** Documentar componentes UI com exemplos.
- **JSDoc:** Documentar funções e hooks públicos.
- **README:** Manter atualizado com instruções de setup.

---

## Checklist de Conformidade
- [ ] Código segue estrutura de pastas
- [ ] Componentes são funcionais com Hooks
- [ ] Props são destructuradas
- [ ] Sem `console.log` em produção
- [ ] Sem variáveis não utilizadas
- [ ] Sem importações não utilizadas
- [ ] Tailwind CSS usado para estilização
- [ ] Formulários usam React Hook Form + Zod
- [ ] API integrada com React Query
- [ ] Acessibilidade verificada
- [ ] Testes para componentes críticos
- [ ] Lint passa (`npm run lint`)
